> 
> #Perform simple linear regression using the "gala" data set available in the faraway package
> 
> library(faraway)
> data(gala, package="faraway") 
> 
> help(gala)  #describes the dataset and the variables in the data sets
> 
> head(gala)
             Species Endemics  Area Elevation Nearest Scruz Adjacent
Baltra            58       23 25.09       346     0.6   0.6     1.84
Bartolome         31       21  1.24       109     0.6  26.3   572.33
Caldwell           3        3  0.21       114     2.8  58.7     0.78
Champion          25        9  0.10        46     1.9  47.4     0.18
Coamano            2        1  0.05        77     1.9   1.9   903.82
Daphne.Major      18       11  0.34       119     8.0   8.0     1.84
> head(gala[,-2])  #excludes the second variable (column)
             Species  Area Elevation Nearest Scruz Adjacent
Baltra            58 25.09       346     0.6   0.6     1.84
Bartolome         31  1.24       109     0.6  26.3   572.33
Caldwell           3  0.21       114     2.8  58.7     0.78
Champion          25  0.10        46     1.9  47.4     0.18
Coamano            2  0.05        77     1.9   1.9   903.82
Daphne.Major      18  0.34       119     8.0   8.0     1.84
> 
> #Simple Linear Regression 
> ##always plot the data
> 
> windows(7,7)
> #save graph in pdf
>  pdf(file="C:/Users/jmard/Desktop/Computing and Graphics in Applied Statistics2020/Lecture 03 28Jan2020/estim1R_out.pdf")
> 
> plot(Species ~ Elevation,data=gala)
> 
> #fit a straight line (least squares line) through the data
> lmod <- lm(Species ~ Elevation,data=gala)
> abline(lmod)
> 
> summary(lmod)  #we are interested in the test of slope:  H0: slope=0   H1: slope not equal to 0

Call:
lm(formula = Species ~ Elevation, data = gala)

Residuals:
     Min       1Q   Median       3Q      Max 
-218.319  -30.721  -14.690    4.634  259.180 

Coefficients:
            Estimate Std. Error t value Pr(>|t|)    
(Intercept) 11.33511   19.20529   0.590     0.56    
Elevation    0.20079    0.03465   5.795 3.18e-06 ***
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Residual standard error: 78.66 on 28 degrees of freedom
Multiple R-squared:  0.5454,    Adjusted R-squared:  0.5291 
F-statistic: 33.59 on 1 and 28 DF,  p-value: 3.177e-06

> #When p is low (<0.05) then H0 must go
> 
> plot(Species ~ Nearest,data=gala)
> #fit a straight line (least squares line) through the data
> lmod <- lm(Species ~ Nearest,data=gala)
> abline(lmod)
> 
> summary(lmod)  #we are interested in the test of slope:  H0: slope=0   H1: slope not equal to 0

Call:
lm(formula = Species ~ Nearest, data = gala)

Residuals:
   Min     1Q Median     3Q    Max 
-84.16 -71.78 -41.66   9.84 357.70 

Coefficients:
            Estimate Std. Error t value Pr(>|t|)   
(Intercept)  86.3720    26.2035   3.296  0.00267 **
Nearest      -0.1132     1.5175  -0.075  0.94107   
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Residual standard error: 116.7 on 28 degrees of freedom
Multiple R-squared:  0.0001986, Adjusted R-squared:  -0.03551 
F-statistic: 0.005563 on 1 and 28 DF,  p-value: 0.9411

> 
> plot(lmod)   #this plot statement generates various plots that we will review later
> 
> # Basic Scatterplot Matrix
> pairs(~ Species +Area + Elevation + Nearest + Scruz  + Adjacent, data=gala, main="Simple Scatterplot Matrix")
> 
> pairs(~ Species + Elevation + Adjacent, data=gala, main="Simple Scatterplot Matrix") #focus on the significant variables
> 
> #focus on the Species (the response variable) with Adjacent (one of the covariates)
> plot(Species~Adjacent,data=gala)
> checkmod <- lm(Species ~ Adjacent,data=gala)
> abline(checkmod)
> summary(checkmod)

Call:
lm(formula = Species ~ Adjacent, data = gala)

Residuals:
   Min     1Q Median     3Q    Max 
-85.46 -71.41 -42.60   7.62 359.67 

Coefficients:
            Estimate Std. Error t value Pr(>|t|)    
(Intercept) 84.32743   22.27411   3.786 0.000744 ***
Adjacent     0.00347    0.02505   0.139 0.890831    
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Residual standard error: 116.6 on 28 degrees of freedom
Multiple R-squared:  0.0006847, Adjusted R-squared:  -0.03501 
F-statistic: 0.01918 on 1 and 28 DF,  p-value: 0.8908

> 
> #now fit a multiple regression
> lmod <- lm(Species ~ Area + Elevation + Nearest + Scruz  + Adjacent, data=gala)
> summary(lmod)

Call:
lm(formula = Species ~ Area + Elevation + Nearest + Scruz + Adjacent, 
    data = gala)

Residuals:
     Min       1Q   Median       3Q      Max 
-111.679  -34.898   -7.862   33.460  182.584 

Coefficients:
             Estimate Std. Error t value Pr(>|t|)    
(Intercept)  7.068221  19.154198   0.369 0.715351    
Area        -0.023938   0.022422  -1.068 0.296318    
Elevation    0.319465   0.053663   5.953 3.82e-06 ***
Nearest      0.009144   1.054136   0.009 0.993151    
Scruz       -0.240524   0.215402  -1.117 0.275208    
Adjacent    -0.074805   0.017700  -4.226 0.000297 ***
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Residual standard error: 60.98 on 24 degrees of freedom
Multiple R-squared:  0.7658,    Adjusted R-squared:  0.7171 
F-statistic:  15.7 on 5 and 24 DF,  p-value: 6.838e-07

> #Adjacent is highly significant in the multiple regression model
> #There are many more concepts to think about when performing multiple regression
> 
> #one detail to point out - the function sumary (not summary) developed by Faraway
> require(faraway)
> sumary(lmod) #sumary (only 1 "m") offers a subset of information provided by summary
             Estimate Std. Error t value  Pr(>|t|)
(Intercept)  7.068221  19.154198  0.3690 0.7153508
Area        -0.023938   0.022422 -1.0676 0.2963180
Elevation    0.319465   0.053663  5.9532 3.823e-06
Nearest      0.009144   1.054136  0.0087 0.9931506
Scruz       -0.240524   0.215402 -1.1166 0.2752082
Adjacent    -0.074805   0.017700 -4.2262 0.0002971

n = 30, p = 6, Residual SE = 60.97519, R-Squared = 0.77
> 
> ##---------------------------------------------------------------------##
> dev.off()
windows 
      2 
> 
