
R version 3.6.2 (2019-12-12) -- "Dark and Stormy Night"
Copyright (C) 2019 The R Foundation for Statistical Computing
Platform: x86_64-w64-mingw32/x64 (64-bit)

R is free software and comes with ABSOLUTELY NO WARRANTY.
You are welcome to redistribute it under certain conditions.
Type 'license()' or 'licence()' for distribution details.

  Natural language support but running in an English locale

R is a collaborative project with many contributors.
Type 'contributors()' for more information and
'citation()' on how to cite R or R packages in publications.

Type 'demo()' for some demos, 'help()' for on-line help, or
'help.start()' for an HTML browser interface to help.
Type 'q()' to quit R.

[Previously saved workspace restored]

> library(faraway)  
> data(prostate,package="faraway") 
> 
> #save graph in pdf
>  pdf(file="C:/Users/jmard/OneDrive/Desktop/RegressionMethodsSpring2020/Ridge_Lasso/Ridge_Lasso_prostate_Figure.pdf")
> 
> if (FALSE)
+ {"
+ lcavol log(cancer volume)
+ lweight log(prostate weight)
+ age age
+ lbph log(benign prostatic hyperplasia amount)
+ svi seminal vesicle invasion
+ lcp log(capsular penetration)
+ gleason Gleason score
+ pgg45 percentage Gleason scores 4 or 5
+ lpsa log(prostate specific antigen)
+ "}
> 
> head(prostate)
      lcavol lweight age      lbph svi      lcp gleason pgg45     lpsa
1 -0.5798185  2.7695  50 -1.386294   0 -1.38629       6     0 -0.43078
2 -0.9942523  3.3196  58 -1.386294   0 -1.38629       6     0 -0.16252
3 -0.5108256  2.6912  74 -1.386294   0 -1.38629       7    20 -0.16252
4 -1.2039728  3.2828  58 -1.386294   0 -1.38629       6     0 -0.16252
5  0.7514161  3.4324  62 -1.386294   0 -1.38629       6     0  0.37156
6 -1.0498221  3.2288  50 -1.386294   0 -1.38629       6     0  0.76547
> summary(prostate)
     lcavol           lweight           age             lbph              svi              lcp             gleason          pgg45             lpsa        
 Min.   :-1.3471   Min.   :2.375   Min.   :41.00   Min.   :-1.3863   Min.   :0.0000   Min.   :-1.3863   Min.   :6.000   Min.   :  0.00   Min.   :-0.4308  
 1st Qu.: 0.5128   1st Qu.:3.376   1st Qu.:60.00   1st Qu.:-1.3863   1st Qu.:0.0000   1st Qu.:-1.3863   1st Qu.:6.000   1st Qu.:  0.00   1st Qu.: 1.7317  
 Median : 1.4469   Median :3.623   Median :65.00   Median : 0.3001   Median :0.0000   Median :-0.7985   Median :7.000   Median : 15.00   Median : 2.5915  
 Mean   : 1.3500   Mean   :3.653   Mean   :63.87   Mean   : 0.1004   Mean   :0.2165   Mean   :-0.1794   Mean   :6.753   Mean   : 24.38   Mean   : 2.4784  
 3rd Qu.: 2.1270   3rd Qu.:3.878   3rd Qu.:68.00   3rd Qu.: 1.5581   3rd Qu.:0.0000   3rd Qu.: 1.1786   3rd Qu.:7.000   3rd Qu.: 40.00   3rd Qu.: 3.0564  
 Max.   : 3.8210   Max.   :6.108   Max.   :79.00   Max.   : 2.3263   Max.   :1.0000   Max.   : 2.9042   Max.   :9.000   Max.   :100.00   Max.   : 5.5829  
> 
> prostate$svi <- factor(prostate$svi)
> summary(prostate$svi)
 0  1 
76 21 
> #------------------------------------------------#
> library(MASS)
> fit <- lm.ridge(lpsa~.,prostate,lambda=seq(0,50,by=0.1))
> fit$GCV
        0.0         0.1         0.2         0.3         0.4         0.5         0.6         0.7         0.8         0.9         1.0         1.1         1.2         1.3         1.4 
0.005575435 0.005573318 0.005571258 0.005569255 0.005567307 0.005565414 0.005563573 0.005561784 0.005560046 0.005558358 0.005556719 0.005555127 0.005553582 0.005552082 0.005550628 
        1.5         1.6         1.7         1.8         1.9         2.0         2.1         2.2         2.3         2.4         2.5         2.6         2.7         2.8         2.9 
0.005549217 0.005547850 0.005546525 0.005545241 0.005543997 0.005542794 0.005541629 0.005540502 0.005539413 0.005538361 0.005537344 0.005536363 0.005535416 0.005534504 0.005533624 
        3.0         3.1         3.2         3.3         3.4         3.5         3.6         3.7         3.8         3.9         4.0         4.1         4.2         4.3         4.4 
0.005532778 0.005531963 0.005531180 0.005530428 0.005529706 0.005529014 0.005528351 0.005527716 0.005527110 0.005526531 0.005525980 0.005525455 0.005524956 0.005524483 0.005524035 
        4.5         4.6         4.7         4.8         4.9         5.0         5.1         5.2         5.3         5.4         5.5         5.6         5.7         5.8         5.9 
0.005523612 0.005523213 0.005522838 0.005522486 0.005522158 0.005521852 0.005521568 0.005521306 0.005521066 0.005520847 0.005520649 0.005520470 0.005520313 0.005520174 0.005520055 
        6.0         6.1         6.2         6.3         6.4         6.5         6.6         6.7         6.8         6.9         7.0         7.1         7.2         7.3         7.4 
0.005519956 0.005519874 0.005519812 0.005519767 0.005519740 0.005519731 0.005519739 0.005519764 0.005519805 0.005519863 0.005519937 0.005520027 0.005520132 0.005520253 0.005520389 
        7.5         7.6         7.7         7.8         7.9         8.0         8.1         8.2         8.3         8.4         8.5         8.6         8.7         8.8         8.9 
0.005520540 0.005520705 0.005520885 0.005521079 0.005521287 0.005521508 0.005521744 0.005521992 0.005522253 0.005522528 0.005522815 0.005523114 0.005523426 0.005523750 0.005524085 
        9.0         9.1         9.2         9.3         9.4         9.5         9.6         9.7         9.8         9.9        10.0        10.1        10.2        10.3        10.4 
0.005524433 0.005524792 0.005525162 0.005525544 0.005525937 0.005526340 0.005526754 0.005527179 0.005527614 0.005528060 0.005528515 0.005528981 0.005529456 0.005529941 0.005530435 
       10.5        10.6        10.7        10.8        10.9        11.0        11.1        11.2        11.3        11.4        11.5        11.6        11.7        11.8        11.9 
0.005530938 0.005531451 0.005531973 0.005532504 0.005533044 0.005533592 0.005534149 0.005534715 0.005535289 0.005535871 0.005536461 0.005537059 0.005537665 0.005538279 0.005538900 
       12.0        12.1        12.2        12.3        12.4        12.5        12.6        12.7        12.8        12.9        13.0        13.1        13.2        13.3        13.4 
0.005539529 0.005540165 0.005540809 0.005541459 0.005542117 0.005542782 0.005543454 0.005544133 0.005544818 0.005545511 0.005546209 0.005546914 0.005547626 0.005548344 0.005549068 
       13.5        13.6        13.7        13.8        13.9        14.0        14.1        14.2        14.3        14.4        14.5        14.6        14.7        14.8        14.9 
0.005549798 0.005550534 0.005551276 0.005552024 0.005552778 0.005553537 0.005554302 0.005555073 0.005555849 0.005556631 0.005557417 0.005558210 0.005559007 0.005559809 0.005560617 
       15.0        15.1        15.2        15.3        15.4        15.5        15.6        15.7        15.8        15.9        16.0        16.1        16.2        16.3        16.4 
0.005561430 0.005562247 0.005563069 0.005563897 0.005564729 0.005565565 0.005566406 0.005567252 0.005568102 0.005568957 0.005569816 0.005570680 0.005571547 0.005572419 0.005573295 
       16.5        16.6        16.7        16.8        16.9        17.0        17.1        17.2        17.3        17.4        17.5        17.6        17.7        17.8        17.9 
0.005574175 0.005575060 0.005575948 0.005576840 0.005577736 0.005578636 0.005579540 0.005580447 0.005581359 0.005582274 0.005583192 0.005584114 0.005585040 0.005585969 0.005586901 
       18.0        18.1        18.2        18.3        18.4        18.5        18.6        18.7        18.8        18.9        19.0        19.1        19.2        19.3        19.4 
0.005587837 0.005588776 0.005589719 0.005590665 0.005591614 0.005592566 0.005593522 0.005594480 0.005595442 0.005596406 0.005597374 0.005598345 0.005599318 0.005600295 0.005601274 
       19.5        19.6        19.7        19.8        19.9        20.0        20.1        20.2        20.3        20.4        20.5        20.6        20.7        20.8        20.9 
0.005602256 0.005603241 0.005604228 0.005605219 0.005606212 0.005607207 0.005608206 0.005609207 0.005610210 0.005611216 0.005612224 0.005613235 0.005614249 0.005615264 0.005616282 
       21.0        21.1        21.2        21.3        21.4        21.5        21.6        21.7        21.8        21.9        22.0        22.1        22.2        22.3        22.4 
0.005617303 0.005618326 0.005619351 0.005620378 0.005621407 0.005622439 0.005623473 0.005624509 0.005625547 0.005626588 0.005627630 0.005628675 0.005629721 0.005630770 0.005631820 
       22.5        22.6        22.7        22.8        22.9        23.0        23.1        23.2        23.3        23.4        23.5        23.6        23.7        23.8        23.9 
0.005632872 0.005633927 0.005634983 0.005636041 0.005637101 0.005638163 0.005639227 0.005640292 0.005641360 0.005642429 0.005643499 0.005644572 0.005645646 0.005646722 0.005647799 
       24.0        24.1        24.2        24.3        24.4        24.5        24.6        24.7        24.8        24.9        25.0        25.1        25.2        25.3        25.4 
0.005648878 0.005649959 0.005651042 0.005652125 0.005653211 0.005654298 0.005655386 0.005656476 0.005657568 0.005658661 0.005659755 0.005660851 0.005661949 0.005663047 0.005664147 
       25.5        25.6        25.7        25.8        25.9        26.0        26.1        26.2        26.3        26.4        26.5        26.6        26.7        26.8        26.9 
0.005665249 0.005666352 0.005667456 0.005668561 0.005669668 0.005670776 0.005671885 0.005672996 0.005674108 0.005675221 0.005676335 0.005677450 0.005678567 0.005679685 0.005680804 
       27.0        27.1        27.2        27.3        27.4        27.5        27.6        27.7        27.8        27.9        28.0        28.1        28.2        28.3        28.4 
0.005681924 0.005683045 0.005684168 0.005685291 0.005686415 0.005687541 0.005688668 0.005689795 0.005690924 0.005692054 0.005693185 0.005694317 0.005695449 0.005696583 0.005697718 
       28.5        28.6        28.7        28.8        28.9        29.0        29.1        29.2        29.3        29.4        29.5        29.6        29.7        29.8        29.9 
0.005698854 0.005699990 0.005701128 0.005702266 0.005703406 0.005704546 0.005705687 0.005706829 0.005707972 0.005709116 0.005710260 0.005711406 0.005712552 0.005713699 0.005714847 
       30.0        30.1        30.2        30.3        30.4        30.5        30.6        30.7        30.8        30.9        31.0        31.1        31.2        31.3        31.4 
0.005715995 0.005717145 0.005718295 0.005719446 0.005720598 0.005721750 0.005722903 0.005724057 0.005725212 0.005726367 0.005727523 0.005728680 0.005729837 0.005730995 0.005732154 
       31.5        31.6        31.7        31.8        31.9        32.0        32.1        32.2        32.3        32.4        32.5        32.6        32.7        32.8        32.9 
0.005733313 0.005734473 0.005735634 0.005736795 0.005737957 0.005739120 0.005740283 0.005741447 0.005742611 0.005743776 0.005744941 0.005746107 0.005747274 0.005748441 0.005749609 
       33.0        33.1        33.2        33.3        33.4        33.5        33.6        33.7        33.8        33.9        34.0        34.1        34.2        34.3        34.4 
0.005750777 0.005751946 0.005753115 0.005754285 0.005755455 0.005756626 0.005757797 0.005758969 0.005760141 0.005761314 0.005762487 0.005763661 0.005764835 0.005766010 0.005767185 
       34.5        34.6        34.7        34.8        34.9        35.0        35.1        35.2        35.3        35.4        35.5        35.6        35.7        35.8        35.9 
0.005768360 0.005769536 0.005770713 0.005771889 0.005773066 0.005774244 0.005775422 0.005776600 0.005777779 0.005778958 0.005780138 0.005781318 0.005782498 0.005783678 0.005784859 
       36.0        36.1        36.2        36.3        36.4        36.5        36.6        36.7        36.8        36.9        37.0        37.1        37.2        37.3        37.4 
0.005786041 0.005787222 0.005788404 0.005789587 0.005790769 0.005791952 0.005793136 0.005794319 0.005795503 0.005796687 0.005797872 0.005799057 0.005800242 0.005801427 0.005802613 
       37.5        37.6        37.7        37.8        37.9        38.0        38.1        38.2        38.3        38.4        38.5        38.6        38.7        38.8        38.9 
0.005803799 0.005804985 0.005806172 0.005807358 0.005808545 0.005809733 0.005810920 0.005812108 0.005813296 0.005814484 0.005815672 0.005816861 0.005818050 0.005819239 0.005820428 
       39.0        39.1        39.2        39.3        39.4        39.5        39.6        39.7        39.8        39.9        40.0        40.1        40.2        40.3        40.4 
0.005821618 0.005822808 0.005823998 0.005825188 0.005826378 0.005827569 0.005828759 0.005829950 0.005831141 0.005832332 0.005833524 0.005834715 0.005835907 0.005837099 0.005838291 
       40.5        40.6        40.7        40.8        40.9        41.0        41.1        41.2        41.3        41.4        41.5        41.6        41.7        41.8        41.9 
0.005839483 0.005840676 0.005841868 0.005843061 0.005844254 0.005845447 0.005846640 0.005847833 0.005849026 0.005850220 0.005851413 0.005852607 0.005853801 0.005854994 0.005856188 
       42.0        42.1        42.2        42.3        42.4        42.5        42.6        42.7        42.8        42.9        43.0        43.1        43.2        43.3        43.4 
0.005857383 0.005858577 0.005859771 0.005860965 0.005862160 0.005863354 0.005864549 0.005865744 0.005866939 0.005868134 0.005869329 0.005870524 0.005871719 0.005872914 0.005874109 
       43.5        43.6        43.7        43.8        43.9        44.0        44.1        44.2        44.3        44.4        44.5        44.6        44.7        44.8        44.9 
0.005875304 0.005876500 0.005877695 0.005878891 0.005880086 0.005881282 0.005882477 0.005883673 0.005884868 0.005886064 0.005887260 0.005888456 0.005889651 0.005890847 0.005892043 
       45.0        45.1        45.2        45.3        45.4        45.5        45.6        45.7        45.8        45.9        46.0        46.1        46.2        46.3        46.4 
0.005893239 0.005894435 0.005895631 0.005896827 0.005898023 0.005899219 0.005900415 0.005901610 0.005902806 0.005904002 0.005905198 0.005906394 0.005907590 0.005908786 0.005909982 
       46.5        46.6        46.7        46.8        46.9        47.0        47.1        47.2        47.3        47.4        47.5        47.6        47.7        47.8        47.9 
0.005911178 0.005912374 0.005913570 0.005914766 0.005915961 0.005917157 0.005918353 0.005919549 0.005920745 0.005921940 0.005923136 0.005924332 0.005925527 0.005926723 0.005927918 
       48.0        48.1        48.2        48.3        48.4        48.5        48.6        48.7        48.8        48.9        49.0        49.1        49.2        49.3        49.4 
0.005929114 0.005930309 0.005931505 0.005932700 0.005933895 0.005935091 0.005936286 0.005937481 0.005938676 0.005939871 0.005941066 0.005942261 0.005943456 0.005944651 0.005945845 
       49.5        49.6        49.7        49.8        49.9        50.0 
0.005947040 0.005948235 0.005949429 0.005950624 0.005951818 0.005953012 
> 
> #perform multiple regression
> modlm <- lm(lpsa ~ lcavol + lweight + age + lbph + svi + lcp + gleason + pgg45, prostate)
> summary(modlm)

Call:
lm(formula = lpsa ~ lcavol + lweight + age + lbph + svi + lcp + 
    gleason + pgg45, data = prostate)

Residuals:
    Min      1Q  Median      3Q     Max 
-1.7331 -0.3713 -0.0170  0.4141  1.6381 

Coefficients:
             Estimate Std. Error t value Pr(>|t|)    
(Intercept)  0.669337   1.296387   0.516  0.60693    
lcavol       0.587022   0.087920   6.677 2.11e-09 ***
lweight      0.454467   0.170012   2.673  0.00896 ** 
age         -0.019637   0.011173  -1.758  0.08229 .  
lbph         0.107054   0.058449   1.832  0.07040 .  
svi1         0.766157   0.244309   3.136  0.00233 ** 
lcp         -0.105474   0.091013  -1.159  0.24964    
gleason      0.045142   0.157465   0.287  0.77503    
pgg45        0.004525   0.004421   1.024  0.30886    
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Residual standard error: 0.7084 on 88 degrees of freedom
Multiple R-squared:  0.6548,    Adjusted R-squared:  0.6234 
F-statistic: 20.86 on 8 and 88 DF,  p-value: < 2.2e-16

> 
> library(glmnet) # include glmnet library including functions for finding the lasso
Loading required package: Matrix
Loaded glmnet 3.0-2

Warning message:
package ‘glmnet’ was built under R version 3.6.3 
> #------------------------------------------------#
> # glmnet requires design matrix and response variable
> 
> x<-(apply(prostate[,-9],2,as.numeric))
> head(x)
         lcavol lweight age      lbph svi      lcp gleason pgg45
[1,] -0.5798185  2.7695  50 -1.386294   0 -1.38629       6     0
[2,] -0.9942523  3.3196  58 -1.386294   0 -1.38629       6     0
[3,] -0.5108256  2.6912  74 -1.386294   0 -1.38629       7    20
[4,] -1.2039728  3.2828  58 -1.386294   0 -1.38629       6     0
[5,]  0.7514161  3.4324  62 -1.386294   0 -1.38629       6     0
[6,] -1.0498221  3.2288  50 -1.386294   0 -1.38629       6     0
> 
> y<-(prostate[,9])
> head(y)
[1] -0.43078 -0.16252 -0.16252 -0.16252  0.37156  0.76547
> 
> lassofit<-glmnet(x,y)
> 
> print(lassofit) # DF gives the number of non-zero coefficients

Call:  glmnet(x = x, y = y) 

   Df    %Dev  Lambda
1   0 0.00000 0.84340
2   1 0.09159 0.76850
3   1 0.16760 0.70020
4   1 0.23070 0.63800
5   1 0.28320 0.58130
6   1 0.32670 0.52970
7   1 0.36280 0.48260
8   1 0.39280 0.43980
9   2 0.42210 0.40070
10  2 0.44900 0.36510
11  2 0.47130 0.33270
12  2 0.48980 0.30310
13  3 0.51250 0.27620
14  3 0.53180 0.25160
15  3 0.54790 0.22930
16  3 0.56120 0.20890
17  3 0.57230 0.19040
18  3 0.58150 0.17350
19  3 0.58910 0.15800
20  5 0.59650 0.14400
21  5 0.60380 0.13120
22  5 0.60990 0.11960
23  5 0.61490 0.10890
24  5 0.61900 0.09926
25  5 0.62250 0.09044
26  5 0.62530 0.08240
27  5 0.62770 0.07508
28  5 0.62970 0.06841
29  5 0.63130 0.06234
30  6 0.63340 0.05680
31  6 0.63610 0.05175
32  6 0.63830 0.04715
33  6 0.64020 0.04297
34  6 0.64170 0.03915
35  6 0.64300 0.03567
36  7 0.64410 0.03250
37  7 0.64500 0.02961
38  7 0.64570 0.02698
39  7 0.64640 0.02459
40  7 0.64690 0.02240
41  8 0.64800 0.02041
42  8 0.64920 0.01860
43  8 0.65010 0.01695
44  8 0.65090 0.01544
45  8 0.65150 0.01407
46  8 0.65210 0.01282
47  8 0.65250 0.01168
48  8 0.65290 0.01064
49  8 0.65320 0.00970
50  8 0.65350 0.00884
51  8 0.65370 0.00805
52  8 0.65390 0.00734
53  8 0.65400 0.00668
54  8 0.65420 0.00609
55  8 0.65430 0.00555
56  8 0.65430 0.00506
57  8 0.65440 0.00461
58  8 0.65450 0.00420
59  8 0.65450 0.00382
60  8 0.65460 0.00348
61  8 0.65460 0.00318
62  8 0.65460 0.00289
63  8 0.65460 0.00264
64  8 0.65470 0.00240
65  8 0.65470 0.00219
66  8 0.65470 0.00199
67  8 0.65470 0.00182
68  8 0.65470 0.00166
69  8 0.65470 0.00151
70  8 0.65470 0.00138
> 
> par(mfrow = c(1, 2))
> 
> plot(lassofit, xvar="lambda")
> #------------------------------------------------#
> 
> plot(lassofit, xvar="norm")
> #------------------------------------------------#
> 
> par(mfrow = c(1, 1))
> coef(lassofit)
9 x 70 sparse Matrix of class "dgCMatrix"
   [[ suppressing 70 column names ‘s0’, ‘s1’, ‘s2’ ... ]]
                                                                                                                                                                                       
(Intercept) 2.478387 2.39211813 2.3135131 2.2418912 2.1766320 2.1171702 2.0629908 2.013625 1.97009292 1.93129251 1.8959478 1.8637429 1.68569619 1.5121334 1.3539831 1.2098823 1.0785831
lcavol      .        0.06390242 0.1221279 0.1751808 0.2235207 0.2675661 0.3076987 0.344266 0.37049898 0.39023459 0.4082084 0.4245854 0.43613872 0.4463923 0.4557421 0.4642612 0.4720235
lweight     .        .          .         .         .         .         .         .        .          .          .         .         0.04197395 0.0834227 0.1211891 0.1556004 0.1869547
age         .        .          .         .         .         .         .         .        .          .          .         .         .          .         .         .         .        
lbph        .        .          .         .         .         .         .         .        .          .          .         .         .          .         .         .         .        
svi         .        .          .         .         .         .         .         .        0.03749244 0.09364689 0.1448259 0.1914583 0.23363883 0.2720734 0.3070828 0.3389821 0.3680476
lcp         .        .          .         .         .         .         .         .        .          .          .         .         .          .         .         .         .        
gleason     .        .          .         .         .         .         .         .        .          .          .         .         .          .         .         .         .        
pgg45       .        .          .         .         .         .         .         .        .          .          .         .         .          .         .         .         .        
                                                                                                                                                                                       
(Intercept) 0.9589482 0.8499186 7.708109e-01 0.7085146244 0.6514768860 0.599505713 0.5521515211 0.5090041454 0.469689864 0.433868154 0.401228747 0.371488935  0.3758542387  0.430111841
lcavol      0.4790963 0.4855653 4.911178e-01 0.4948397776 0.4982647196 0.501385849 0.5042297038 0.5068209187 0.509181937 0.511333209 0.513293368 0.515079392  0.5171198343  0.519618122
lweight     0.2155235 0.2415538 2.594293e-01 0.2723153939 0.2841264439 0.294888265 0.3046940338 0.3136286853 0.321769607 0.329187312 0.335946048 0.342104357  0.3492904425  0.358144843
age         .         .         .            .            .            .           .            .            .           .           .           .           -0.0006046384 -0.002109005
lbph        .         .         4.537318e-03 0.0115353608 0.0178871200 0.023674573 0.0289478859 0.0337527319 0.038130729 0.042119796 0.045754486 0.049066280  0.0528732759  0.057587221
svi         0.3945309 0.4186238 4.422360e-01 0.4611802448 0.4782888222 0.493877253 0.5080808548 0.5210226474 0.532814727 0.543559230 0.553349222 0.562269498  0.5700828116  0.576441972
lcp         .         .         .            .            .            .           .            .            .           .           .           .            .             .          
gleason     .         .         .            .            .            .           .            .            .           .           .           .            .             .          
pgg45       .         .         3.078664e-05 0.0002522331 0.0004544603 0.000638716 0.0008066028 0.0009595751 0.001098958 0.001225958 0.001341676 0.001447114  0.0015772855  0.001751819
                                                                                                                                                                                     
(Intercept)  0.478968977  0.523486736  0.564049649  0.601009066  0.6344105058  0.643640105  0.652180829  0.659545520  0.666640524  0.667857506  0.668914088  0.668976548  0.668579508
lcavol       0.521941757  0.524058567  0.525987325  0.527744738  0.5293460268  0.530467103  0.531449191  0.532343997  0.533159209  0.536944795  0.541420475  0.545471920  0.549181138
lweight      0.366256229  0.373646921  0.380381046  0.386516930  0.3921077184  0.397726652  0.402786531  0.407476008  0.411671289  0.415297010  0.418777406  0.421949204  0.424796629
age         -0.003473621 -0.004717011 -0.005849943 -0.006882227 -0.0078228068 -0.008700241 -0.009500601 -0.010226758 -0.010891473 -0.011619539 -0.012334612 -0.012983473 -0.013569375
lbph         0.061866245  0.065765208  0.069317797  0.072554785  0.0755042068  0.078122049  0.080528949  0.082702971  0.084702672  0.086683987  0.088492044  0.090140743  0.091646032
svi          0.582235686  0.587515318  0.592325921  0.596709163  0.6007030093  0.604772031  0.608596598  0.612059856  0.615238557  0.625950988  0.638431426  0.649778220  0.660008627
lcp          .            .            .            .            .             .            .            .            .           -0.006840468 -0.015679002 -0.023658946 -0.030830237
gleason      .            .            .            .            0.0000437045  0.003402035  0.006489121  0.009292206  0.011860035  0.014826507  0.017384243  0.019846198  0.022147101
pgg45        0.001909575  0.002053320  0.002184295  0.002303634  0.0024115301  0.002450489  0.002485423  0.002517367  0.002546271  0.002675516  0.002844385  0.002993873  0.003125893
                                                                                                                                                                                    
(Intercept)  0.668625667  0.668687574  0.668745168  0.668797714  0.668845595  0.668889224  0.668394263  0.668425204  0.668500575  0.668574271  0.668641942  0.668703656  0.668128771
lcavol       0.552542904  0.555605900  0.558396803  0.560939772  0.563256829  0.565368046  0.567298860  0.569050817  0.570647224  0.572101888  0.573427333  0.574635031  0.575731728
lweight      0.427430857  0.429832654  0.432021136  0.434015202  0.435832121  0.437487630  0.438969939  0.440344054  0.441598549  0.442741767  0.443783440  0.444732576  0.445585471
age         -0.014108276 -0.014599442 -0.015046980 -0.015454760 -0.015826314 -0.016164861 -0.016468240 -0.016749445 -0.017005957 -0.017239704 -0.017452689 -0.017646753 -0.017818373
lbph         0.093015164  0.094262352  0.095398730  0.096434155  0.097377595  0.098237223  0.099019919  0.099734135  0.100384457  0.100976968  0.101516837  0.102008747  0.102452958
svi          0.669437962  0.678030224  0.685859191  0.692992656  0.699492404  0.705414732  0.710684757  0.715610122  0.720100435  0.724191987  0.727920071  0.731316963  0.734263172
lcp         -0.037458372 -0.043500571 -0.049006135 -0.054022607 -0.058593431 -0.062758195 -0.066453279 -0.069913040 -0.073071590 -0.075950092 -0.078572932 -0.080962771 -0.083035145
gleason      0.024193181  0.026054376  0.027750043  0.029295061  0.030702824  0.031985525  0.033219150  0.034286184  0.035251394  0.036130100  0.036930666  0.037660103  0.038398222
pgg45        0.003250039  0.003363316  0.003466536  0.003560588  0.003646284  0.003724367  0.003791516  0.003856333  0.003915721  0.003969865  0.004019202  0.004064156  0.004101125
                                                                                                                                                                                    
(Intercept)  0.668119994  0.668206692  0.668303199  0.668394313  0.668477906  0.667859913  0.667768811  0.667839734  0.667952101  0.668068927  0.667370696  0.667131455  0.667126522
lcavol       0.576733671  0.577647246  0.578479979  0.579238798  0.579930218  0.580543645  0.581115852  0.581639029  0.582116727  0.582552331  0.582912947  0.583268229  0.583596359
lweight      0.446370986  0.447089791  0.447745127  0.448342304  0.448886441  0.449386170  0.449834792  0.450245729  0.450620627  0.450962325  0.451295182  0.451579310  0.451836840
age         -0.017979320 -0.018126505 -0.018260693 -0.018382973 -0.018494392 -0.018590699 -0.018682543 -0.018767067 -0.018844285 -0.018914699 -0.018973058 -0.019030080 -0.019083230
lbph         0.102862232  0.103234720  0.103574034  0.103883191  0.104164880  0.104413978  0.104648526  0.104862331  0.105057069  0.105234484  0.105384083  0.105530495  0.105665434
svi          0.737088441  0.739669971  0.742022893  0.744166904  0.746120468  0.747734870  0.749351272  0.750840619  0.752200360  0.753439982  0.754375339  0.755373403  0.756317172
lcp         -0.085014791 -0.086830141 -0.088486044 -0.089995161 -0.091370269 -0.092516771 -0.093643047 -0.094687419 -0.095643752 -0.096516491 -0.097195645 -0.097886855 -0.098542353
gleason      0.039013860  0.039561365  0.040057668  0.040509413  0.040920942  0.041372353  0.041737468  0.042049570  0.042327202  0.042578109  0.042889332  0.043142879  0.043347790
pgg45        0.004138079  0.004172349  0.004203676  0.004232238  0.004258266  0.004278238  0.004298936  0.004318675  0.004336917  0.004353614  0.004365172  0.004377342  0.004389509
> 
> # Cross Validation
> cvlassofit <- cv.glmnet(x,y)
> print(cvlassofit)

Call:  cv.glmnet(x = x, y = y) 

Measure: Mean-Squared Error 

     Lambda Measure      SE Nonzero
min 0.01168  0.5580 0.08966       8
1se 0.19036  0.6335 0.11598       3
> plot(cvlassofit)
> 
> coef(cvlassofit, s = "lambda.min") # to get the coefficients for the "optimal" lambda
9 x 1 sparse Matrix of class "dgCMatrix"
                       1
(Intercept)  0.668745168
lcavol       0.558396803
lweight      0.432021136
age         -0.015046980
lbph         0.095398730
svi          0.685859191
lcp         -0.049006135
gleason      0.027750043
pgg45        0.003466536
> 
> #choose the largest value of lambda which is within 1 SE of the minimum
> coef(cvlassofit, s = "lambda.1se") # to get the coefficients for the one SE lambda
9 x 1 sparse Matrix of class "dgCMatrix"
                    1
(Intercept) 1.0785831
lcavol      0.4720235
lweight     0.1869547
age         .        
lbph        .        
svi         0.3680476
lcp         .        
gleason     .        
pgg45       .        
> 
> dev.off()
null device 
          1 
> 
