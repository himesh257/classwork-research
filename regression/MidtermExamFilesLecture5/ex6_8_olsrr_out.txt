> #I found another package that performs variable selection methods and generates more readable output.
> #See the manual at https://cran.r-project.org/web/packages/olsrr/olsrr.pdf 
> #See an example at https://cran.r-project.org/web/packages/olsrr/vignettes/variable_selection.html
> 
> #R code to demonstrate Variable Selection: stepwise and all possible
> #will perform stepwise (forward, backward, stepwise)
> #and all possible regressions  k=7 so 2**7 = 128 possible regressions
> 
> #this site below has a useful tutorial on Variable Selection in R
> #https://rpubs.com/davoodastaraky/subset
> 
> library(faraway)  #this command brings in a library of regression functions
> #Exercise 6.8 (CLERICAL), page 352, 8th edition which is Exercise 6.6, page 340 7th edition
> 
> #read in the data which is in a csv file
> #change the directory below to your directory
> #note header=TRUE below tells R that the first row of the csv file contains variable names
> ex6_8 <- read.csv(file="C:/Users/jmard/Desktop/RegressionMethodsSpring2020/Lecture 04 11FEB2020/CLERICAL.csv",header = TRUE)
> ex6_8   #ignore DAY variable
   OBS DAY     Y    X1  X2   X3  X4   X5 X6   X7
1    1   M 128.5  7781 100  886 235  644 56  737
2    2   T 113.6  7004 110  962 388  589 57 1029
3    3   W 146.6  7267  61 1342 398 1081 59  830
4    4  Th 124.3  2129 102 1153 457  891 57 1468
5    5   F 100.4  4878  45  803 577  537 49  335
6    6   S 119.2  3999 144 1127 345  563 64  918
7    7   M 109.5 11777 123  627 326  402 60  335
8    8   T 128.5  5764  78  748 161  495 57  962
9    9   W 131.2  7392 172  876 219  823 62  665
10  10  Th 112.2  8100 126  685 287  555 86  577
11  11   F  95.4  4736 115  436 235  456 38  214
12  12   S 124.6  4337 110  899 127  573 73  484
13  13   M 103.7  3079  96  570 180  428 59  456
14  14   T 103.6  7273  51  826 118  463 53  907
15  15   W 133.2  4091 116 1060 206  961 67  951
16  16  Th 111.4  3390  70  957 284  745 77 1446
17  17   F  97.7  6319  58  559 220  539 41  440
18  18   S 132.1  7447  83 1050 174  553 63 1133
19  19   M 135.9  7100  80  568 124  428 55  456
20  20   T 131.3  8035 115  709 174  498 78  968
21  21   W 150.4  5579  83  568 223  683 79  660
22  22  Th 124.9  4338  78  900 115  556 84  555
23  23   F  97.0  6895  18  442 118  479 41  203
24  24   S 114.1  3629 133  644 155  505 57  781
25  25   M  88.3  5149  92  389 124  405 59  236
26  26   T 117.6  5241 110  612 222  477 55  616
27  27   W 128.2  2917  69 1057 378  970 80 1210
28  28  Th 138.8  4390  70  974 195 1027 81 1452
29  29   F 109.5  4957  24  783 358  893 51  616
30  30   S 118.9  7099 130 1419 374  609 62  957
31  31   M 122.2  7337 128 1137 238  461 51  968
32  32   T 142.8  8301 115  946 191  771 74  719
33  33   W 133.9  4889  86  750 214  513 69  489
34  34  Th 100.2  6308  81  461 132  430 49  341
35  35   F 116.8  6908 145  864 164  549 57  902
36  36   S  97.3  5345 116  604 127  360 48  126
37  37   M  98.0  6994  59  714 107  473 53  726
38  38   T 136.5  6781  78  917 171  805 74 1100
39  39   W 111.7  3142 106  809 335  702 70 1721
40  40  Th  98.6  5738  27  546 126  455 52  502
41  41   F 116.2  4931 174  891 129  481 71  737
42  42   S 108.9  6501  69  643 129  334 47  473
43  43   M 120.6  5678  94  828 107  384 52 1083
44  44   T 131.8  4619 100  777 164  834 67  841
45  45   W 112.4  1832 124  626 158  571 71  627
46  46  Th  92.5  5445  52  432 121  458 42  313
47  47   F 120.0  4123  84  432 153  544 42  654
48  48   S 112.2  5884  89 1061 100  391 31  280
49  49   M 113.0  5505  45  562  84  444 36  814
50  50   T 138.7  2882  94  601 139  799 44  907
51  51   W 122.1  2395  89  637 201  747 30 1666
52  52  Th  86.6  6847  14  810 230  547 40  614
> 
> #install.packages("olsrr")  #install olsrr if package has not been installed on your computer
> #Because R is developed by an open source community, it is not uncommon
> # that multiple packages may use the same name for a function or dataset.
> # If you load packages that use the same name for an object, R will warn
> # that certain object(s) have been “masked”.
> require(olsrr)
Loading required package: olsrr
Registered S3 methods overwritten by 'car':
  method                          from
  influence.merMod                lme4
  cooks.distance.influence.merMod lme4
  dfbeta.influence.merMod         lme4
  dfbetas.influence.merMod        lme4

Attaching package: ‘olsrr’

The following object is masked from ‘package:faraway’:

    hsb

The following object is masked from ‘package:datasets’:

    rivers

> 
> lmod <- lm(Y ~ X1+X2+X3+X4+X5+X6+X7,data=ex6_8)
> 
> #save graph in pdf
>  pdf(file="C:/Users/jmard/Desktop/RegressionMethodsSpring2020/Lecture 05 18FEB2020/ex6_8_olsrr_R_out.pdf")
> 
> #all possible regressions
> k <- ols_step_all_possible(lmod)
> k
    Index N           Predictors     R-Square Adj. R-Square Mallow's Cp
5       1 1                   X5 3.449436e-01    0.33184249   18.775229
6       2 1                   X6 2.490136e-01    0.23399391   28.554154
3       3 1                   X3 2.129999e-01    0.19725986   32.225330
7       4 1                   X7 2.021349e-01    0.18617758   33.332886
2       5 1                   X2 8.574310e-02    0.06745797   45.197648
4       6 1                   X4 7.190738e-03   -0.01266545   53.205130
1       7 1                   X1 5.852407e-05   -0.01994031   53.932174
16      8 2                X2 X5 4.362622e-01    0.41325254   11.466378
26      9 2                X5 X6 4.331875e-01    0.41005230   11.779811
23     10 2                X4 X5 3.831555e-01    0.35797821   16.879978
20     11 2                X3 X5 3.806171e-01    0.35533621   17.138737
11     12 2                X1 X5 3.708897e-01    0.34521168   18.130339
27     13 2                X5 X7 3.651318e-01    0.33921880   18.717285
28     14 2                X6 X7 3.485945e-01    0.32200655   20.403062
21     15 2                X3 X6 3.430647e-01    0.31625099   20.966765
22     16 2                X3 X7 2.752420e-01    0.24566008   27.880478
17     17 2                X2 X6 2.662988e-01    0.23635182   28.792135
18     18 2                X2 X7 2.595659e-01    0.22934411   29.478474
24     19 2                X4 X6 2.490153e-01    0.21836290   30.553980
12     20 2                X1 X6 2.490137e-01    0.21836122   30.554144
14     21 2                X2 X3 2.473380e-01    0.21661705   30.724969
19     22 2                X3 X4 2.368687e-01    0.20572053   31.792181
13     23 2                X1 X7 2.215867e-01    0.18981474   33.350003
9      24 2                X1 X3 2.140884e-01    0.18201035   34.114370
25     25 2                X4 X7 2.037698e-01    0.17127057   35.166229
15     26 2                X2 X4 9.122722e-02    0.05413445   46.638607
8      27 2                X1 X2 8.586310e-02    0.04855139   47.185415
10     28 2                X1 X4 7.206718e-03   -0.03331546   55.203501
48     29 3             X2 X4 X5 4.805843e-01    0.44812080    8.948273
51     30 3             X2 X5 X6 4.756979e-01    0.44292902    9.446381
60     31 3             X4 X5 X6 4.711309e-01    0.43807661    9.911929
31     32 3             X1 X2 X5 4.615165e-01    0.42786126   10.892008
54     33 3             X3 X4 X5 4.547233e-01    0.42064349   11.584494
57     34 3             X3 X5 X6 4.510827e-01    0.41677538   11.955607
41     35 3             X1 X5 X6 4.505365e-01    0.41619505   12.011286
45     36 3             X2 X3 X5 4.471967e-01    0.41264644   12.351745
63     37 3             X5 X6 X7 4.455568e-01    0.41090415   12.518904
52     38 3             X2 X5 X7 4.453209e-01    0.41065344   12.542957
38     39 3             X1 X4 X5 4.154999e-01    0.37896866   15.582851
61     40 3             X4 X5 X7 4.052444e-01    0.36807216   16.628281
42     41 3             X1 X5 X7 4.022445e-01    0.36488483   16.934079
35     42 3             X1 X3 X5 3.949732e-01    0.35715908   17.675302
58     43 3             X3 X5 X7 3.883081e-01    0.35007739   18.354731
59     44 3             X3 X6 X7 3.823476e-01    0.34374436   18.962334
55     45 3             X3 X4 X6 3.670196e-01    0.32745836   20.524842
53     46 3             X2 X6 X7 3.639552e-01    0.32420236   20.837228
43     47 3             X1 X6 X7 3.601506e-01    0.32016004   21.225056
62     48 3             X4 X6 X7 3.544403e-01    0.31409279   21.807158
46     49 3             X2 X3 X6 3.508497e-01    0.31027782   22.173173
36     50 3             X1 X3 X6 3.434446e-01    0.30240994   22.928031
47     51 3             X2 X3 X7 3.098577e-01    0.26672385   26.351818
56     52 3             X3 X4 X7 3.025300e-01    0.25893808   27.098799
37     53 3             X1 X3 X7 2.803393e-01    0.23536047   29.360877
33     54 3             X1 X2 X7 2.757179e-01    0.23045028   29.831969
49     55 3             X2 X4 X6 2.663158e-01    0.22046053   30.790404
32     56 3             X1 X2 X6 2.663029e-01    0.22044685   30.791716
44     57 3             X2 X3 X4 2.662816e-01    0.22042417   30.793892
50     58 3             X2 X4 X7 2.612671e-01    0.21509626   31.305061
39     59 3             X1 X4 X6 2.490155e-01    0.20207893   32.553967
29     60 3             X1 X2 X3 2.483994e-01    0.20142436   32.616768
34     61 3             X1 X3 X4 2.389245e-01    0.19135733   33.582616
40     62 3             X1 X4 X7 2.237953e-01    0.17528247   35.124867
30     63 3             X1 X2 X4 9.128705e-02    0.03449250   48.632508
90     64 4          X2 X4 X5 X6 5.182013e-01    0.47719717    7.113662
94     65 4          X3 X4 X5 X6 5.156128e-01    0.47438838    7.377528
84     66 4          X2 X3 X4 X5 5.143129e-01    0.47297783    7.510039
68     67 4          X1 X2 X4 X5 5.126295e-01    0.47115120    7.681639
71     68 4          X1 X2 X5 X6 4.949149e-01    0.45192894    9.487435
80     69 4          X1 X4 X5 X6 4.937641e-01    0.45068022    9.604744
91     70 4          X2 X4 X5 X7 4.907041e-01    0.44735980    9.916674
98     71 4          X4 X5 X6 X7 4.850083e-01    0.44117926   10.497292
87     72 4          X2 X3 X5 X6 4.831123e-01    0.43912190   10.690567
93     73 4          X2 X5 X6 X7 4.829555e-01    0.43895174   10.706552
72     74 4          X1 X2 X5 X7 4.782875e-01    0.43388647   11.182399
83     75 4          X1 X5 X6 X7 4.706603e-01    0.42561007   11.959909
74     76 4          X1 X3 X4 X5 4.701516e-01    0.42505817   12.011755
65     77 4          X1 X2 X3 X5 4.660953e-01    0.42065664   12.425248
77     78 4          X1 X3 X5 X6 4.620261e-01    0.41624108   12.840060
95     79 4          X3 X4 X5 X7 4.592229e-01    0.41319931   13.125812
97     80 4          X3 X5 X6 X7 4.566753e-01    0.41043487   13.385512
88     81 4          X2 X3 X5 X7 4.519096e-01    0.40526362   13.871315
81     82 4          X1 X4 X5 X7 4.509865e-01    0.40426191   13.965419
78     83 4          X1 X3 X5 X7 4.114179e-01    0.36132577   17.998968
96     84 4          X3 X4 X6 X7 4.090382e-01    0.35874352   18.241552
89     85 4          X2 X3 X6 X7 3.918721e-01    0.34011654   19.991426
79     86 4          X1 X3 X6 X7 3.864186e-01    0.33419895   20.547343
73     87 4          X1 X2 X6 X7 3.748137e-01    0.32160641   21.730324
85     88 4          X2 X3 X4 X6 3.724009e-01    0.31898824   21.976282
92     89 4          X2 X4 X6 X7 3.692869e-01    0.31560923   22.293716
75     90 4          X1 X3 X4 X6 3.680325e-01    0.31424800   22.421594
82     91 4          X1 X4 X6 X7 3.666668e-01    0.31276611   22.560808
66     92 4          X1 X2 X3 X6 3.512598e-01    0.29604782   24.131374
86     93 4          X2 X3 X4 X7 3.318551e-01    0.27499171   26.109448
67     94 4          X1 X2 X3 X7 3.150541e-01    0.25676088   27.822106
76     95 4          X1 X3 X4 X7 3.061685e-01    0.24711898   28.727896
70     96 4          X1 X2 X4 X7 2.779471e-01    0.21649580   31.604729
64     97 4          X1 X2 X3 X4 2.681887e-01    0.20590688   32.599484
69     98 4          X1 X2 X4 X6 2.663193e-01    0.20387834   32.790050
114    99 5       X2 X3 X4 X5 X6 5.449760e-01    0.49551685    6.384302
105   100 5       X1 X2 X4 X5 X6 5.434443e-01    0.49381870    6.540437
99    101 5       X1 X2 X3 X4 X5 5.341235e-01    0.48348471    7.490588
106   102 5       X1 X2 X4 X5 X7 5.321800e-01    0.48132997    7.688704
109   103 5       X1 X3 X4 X5 X6 5.276655e-01    0.47632478    8.148901
118   104 5       X2 X4 X5 X6 X7 5.264354e-01    0.47496096    8.274297
119   105 5       X3 X4 X5 X6 X7 5.187853e-01    0.46647933    9.054134
113   106 5       X1 X4 X5 X6 X7 5.172863e-01    0.46481737    9.206941
115   107 5       X2 X3 X4 X5 X7 5.168036e-01    0.46428229    9.256139
108   108 5       X1 X2 X5 X6 X7 5.084437e-01    0.45501364   10.108337
102   109 5       X1 X2 X3 X5 X6 4.979120e-01    0.44333720   11.181918
117   110 5       X2 X3 X5 X6 X7 4.871904e-01    0.43145018   12.274861
110   111 5       X1 X3 X4 X5 X7 4.818079e-01    0.42548267   12.823539
103   112 5       X1 X2 X3 X5 X7 4.788800e-01    0.42223652   13.122004
112   113 5       X1 X3 X5 X6 X7 4.742651e-01    0.41712004   13.592434
116   114 5       X2 X3 X4 X6 X7 4.157940e-01    0.35229330   19.552877
111   115 5       X1 X3 X4 X6 X7 4.118316e-01    0.34790029   19.956790
104   116 5       X1 X2 X3 X6 X7 3.960782e-01    0.33043448   21.562669
107   117 5       X1 X2 X4 X6 X7 3.807793e-01    0.31347268   23.122208
100   118 5       X1 X2 X3 X4 X6 3.734175e-01    0.30531069   23.872656
101   119 5       X1 X2 X3 X4 X7 3.357074e-01    0.26350163   27.716757
120   120 6    X1 X2 X3 X4 X5 X6 5.608627e-01    0.50231110    6.764836
124   121 6    X1 X2 X4 X5 X6 X7 5.595567e-01    0.50083089    6.897974
126   122 6    X2 X3 X4 X5 X6 X7 5.471085e-01    0.48672291    8.166922
121   123 6    X1 X2 X3 X4 X5 X7 5.430458e-01    0.48211863    8.581056
125   124 6    X1 X3 X4 X5 X6 X7 5.362805e-01    0.47445125    9.270702
123   125 6    X1 X2 X3 X5 X6 X7 5.086947e-01    0.44318732   12.082750
122   126 6    X1 X2 X3 X4 X6 X7 4.187414e-01    0.34124029   21.252417
127   127 7 X1 X2 X3 X4 X5 X6 X7 5.683657e-01    0.49969658    8.000000
> plot(k)
> 
> #best subset regregression
> k <- ols_step_best_subset(lmod,print_plot = TRUE)
> k
      Best Subsets Regression      
-----------------------------------
Model Index    Predictors
-----------------------------------
     1         X5                   
     2         X2 X5                
     3         X2 X4 X5             
     4         X2 X4 X5 X6          
     5         X2 X3 X4 X5 X6       
     6         X1 X2 X3 X4 X5 X6    
     7         X1 X2 X3 X4 X5 X6 X7 
-----------------------------------

                                                     Subsets Regression Summary                                                      
-------------------------------------------------------------------------------------------------------------------------------------
                       Adj.        Pred                                                                                               
Model    R-Square    R-Square    R-Square     C(p)        AIC         SBIC        SBC         MSEP         FPE        HSP       APC  
-------------------------------------------------------------------------------------------------------------------------------------
  1        0.3449      0.3318      0.3001    18.7752    415.8625    267.3099    421.7162    8388.2586    167.5119    3.2920    0.7075 
  2        0.4363      0.4133      0.3775    11.4664    410.0556    261.8972    417.8606    7369.2806    149.8260    2.9511    0.6328 
  3        0.4806      0.4481      0.4139     8.9483    407.7976    260.0841    417.5538    6934.3609    143.4846    2.8348    0.6060 
  4        0.5182      0.4772      0.4308     7.1137    405.8883    258.8995    417.5958    6571.9914    138.3522    2.7438    0.5843 
  5        0.5450      0.4955      0.4349     6.3843    404.9152    258.7691    418.5739    6344.6989    135.8463    2.7065    0.5737 
  6        0.5609      0.5023      0.4363     6.7648    405.0672    259.7081    420.6771    6262.3426    136.3274    2.7307    0.5758 
  7        0.5684      0.4997      0.4208     8.0000    406.1711    261.4444    423.7323    6298.4940    139.3663    2.8089    0.5886 
-------------------------------------------------------------------------------------------------------------------------------------
AIC: Akaike Information Criteria 
 SBIC: Sawa's Bayesian Information Criteria 
 SBC: Schwarz Bayesian Criteria 
 MSEP: Estimated error of prediction, assuming multivariate normality 
 FPE: Final Prediction Error 
 HSP: Hocking's Sp 
 APC: Amemiya Prediction Criteria 

> plot(k)
> 
> #Selection criteria output - focus on the criteria starting with ##
> ##rsquare rsquare of the model
> ##adjr adjusted rsquare of the model
> ##predrsq predicted rsquare of the model
> ##cp mallow’s Cp
> ##aic akaike information criteria
> #sbic sawa bayesian information criteria
> ##sbc schwarz bayes information criteria
> ##gmsep estimated MSE of prediction, assuming multivariate normality
> 
> #jp final prediction error
> #pc amemiya prediction criteria
> #sp hocking’s Sp
> 
> #Stepwise Forward Regression
> #Build regression model from a set of candidate predictor variables
> # by entering predictors based on p values, in a stepwise manner until there
> # is no variable left to enter any more. The model should include all
> # the candidate predictor variables. 
> #If details is set to TRUE, each step is displayed.
> 
> k <- ols_step_forward_p(lmod,details=TRUE)
Forward Selection Method    
---------------------------

Candidate Terms: 

1. X1 
2. X2 
3. X3 
4. X4 
5. X5 
6. X6 
7. X7 

We are selecting variables based on p value...


Forward Selection: Step 1 

+ X5 

                         Model Summary                          
---------------------------------------------------------------
R                       0.587       RMSE                12.701 
R-Squared               0.345       Coef. Var           10.820 
Adj. R-Squared          0.332       MSE                161.308 
Pred R-Squared          0.300       MAE                 10.059 
---------------------------------------------------------------
 RMSE: Root Mean Square Error 
 MSE: Mean Square Error 
 MAE: Mean Absolute Error 

                                ANOVA                                 
---------------------------------------------------------------------
                 Sum of                                              
                Squares        DF    Mean Square      F         Sig. 
---------------------------------------------------------------------
Regression     4247.123         1       4247.123    26.329    0.0000 
Residual       8065.390        50        161.308                     
Total         12312.512        51                                    
---------------------------------------------------------------------

                                   Parameter Estimates                                    
-----------------------------------------------------------------------------------------
      model      Beta    Std. Error    Std. Beta      t        Sig      lower      upper 
-----------------------------------------------------------------------------------------
(Intercept)    88.193         5.954                 14.812    0.000    76.234    100.152 
         X5     0.049         0.010        0.587     5.131    0.000     0.030      0.068 
-----------------------------------------------------------------------------------------



Forward Selection: Step 2 

+ X2 

                         Model Summary                          
---------------------------------------------------------------
R                       0.661       RMSE                11.902 
R-Squared               0.436       Coef. Var           10.140 
Adj. R-Squared          0.413       MSE                141.654 
Pred R-Squared          0.377       MAE                  9.727 
---------------------------------------------------------------
 RMSE: Root Mean Square Error 
 MSE: Mean Square Error 
 MAE: Mean Absolute Error 

                                ANOVA                                 
---------------------------------------------------------------------
                 Sum of                                              
                Squares        DF    Mean Square      F         Sig. 
---------------------------------------------------------------------
Regression     5371.484         2       2685.742     18.96    0.0000 
Residual       6941.028        49        141.654                     
Total         12312.512        51                                    
---------------------------------------------------------------------

                                  Parameter Estimates                                    
----------------------------------------------------------------------------------------
      model      Beta    Std. Error    Std. Beta      t        Sig      lower     upper 
----------------------------------------------------------------------------------------
(Intercept)    75.966         7.069                 10.747    0.000    61.762    90.171 
         X5     0.050         0.009        0.592     5.520    0.000     0.032     0.068 
         X2     0.132         0.047        0.302     2.817    0.007     0.038     0.226 
----------------------------------------------------------------------------------------



Forward Selection: Step 3 

+ X4 

                         Model Summary                          
---------------------------------------------------------------
R                       0.693       RMSE                11.543 
R-Squared               0.481       Coef. Var            9.834 
Adj. R-Squared          0.448       MSE                133.236 
Pred R-Squared          0.414       MAE                  9.105 
---------------------------------------------------------------
 RMSE: Root Mean Square Error 
 MSE: Mean Square Error 
 MAE: Mean Absolute Error 

                                ANOVA                                 
---------------------------------------------------------------------
                 Sum of                                              
                Squares        DF    Mean Square      F         Sig. 
---------------------------------------------------------------------
Regression     5917.200         3       1972.400    14.804    0.0000 
Residual       6395.312        48        133.236                     
Total         12312.512        51                                    
---------------------------------------------------------------------

                                  Parameter Estimates                                    
----------------------------------------------------------------------------------------
      model      Beta    Std. Error    Std. Beta      t        Sig      lower     upper 
----------------------------------------------------------------------------------------
(Intercept)    77.726         6.910                 11.248    0.000    63.832    91.620 
         X5     0.058         0.010        0.696     5.998    0.000     0.039     0.078 
         X2     0.136         0.045        0.313     3.001    0.004     0.045     0.228 
         X4    -0.035         0.017       -0.235    -2.024    0.049    -0.069     0.000 
----------------------------------------------------------------------------------------



Forward Selection: Step 4 

+ X6 

                         Model Summary                          
---------------------------------------------------------------
R                       0.720       RMSE                11.235 
R-Squared               0.518       Coef. Var            9.571 
Adj. R-Squared          0.477       MSE                126.216 
Pred R-Squared          0.431       MAE                  8.992 
---------------------------------------------------------------
 RMSE: Root Mean Square Error 
 MSE: Mean Square Error 
 MAE: Mean Absolute Error 

                                ANOVA                                 
---------------------------------------------------------------------
                 Sum of                                              
                Squares        DF    Mean Square      F         Sig. 
---------------------------------------------------------------------
Regression     6380.360         4       1595.090    12.638    0.0000 
Residual       5932.152        47        126.216                     
Total         12312.512        51                                    
---------------------------------------------------------------------

                                  Parameter Estimates                                    
----------------------------------------------------------------------------------------
      model      Beta    Std. Error    Std. Beta      t        Sig      lower     upper 
----------------------------------------------------------------------------------------
(Intercept)    70.449         7.724                  9.121    0.000    54.910    85.988 
         X5     0.051         0.010        0.606     4.957    0.000     0.030     0.071 
         X2     0.102         0.048        0.234     2.143    0.037     0.006     0.198 
         X4    -0.034         0.017       -0.230    -2.036    0.047    -0.068     0.000 
         X6     0.252         0.132        0.226     1.916    0.062    -0.013     0.517 
----------------------------------------------------------------------------------------



Forward Selection: Step 5 

+ X3 

                         Model Summary                          
---------------------------------------------------------------
R                       0.738       RMSE                11.036 
R-Squared               0.545       Coef. Var            9.402 
Adj. R-Squared          0.496       MSE                121.793 
Pred R-Squared          0.435       MAE                  8.590 
---------------------------------------------------------------
 RMSE: Root Mean Square Error 
 MSE: Mean Square Error 
 MAE: Mean Absolute Error 

                                ANOVA                                 
---------------------------------------------------------------------
                 Sum of                                              
                Squares        DF    Mean Square      F         Sig. 
---------------------------------------------------------------------
Regression     6710.023         5       1342.005    11.019    0.0000 
Residual       5602.489        46        121.793                     
Total         12312.512        51                                    
---------------------------------------------------------------------

                                  Parameter Estimates                                    
----------------------------------------------------------------------------------------
      model      Beta    Std. Error    Std. Beta      t        Sig      lower     upper 
----------------------------------------------------------------------------------------
(Intercept)    68.274         7.702                  8.865    0.000    52.771    83.778 
         X5     0.045         0.011        0.534     4.177    0.000     0.023     0.066 
         X2     0.083         0.048        0.191     1.723    0.092    -0.014     0.180 
         X4    -0.043         0.017       -0.294    -2.501    0.016    -0.078    -0.008 
         X6     0.229         0.130        0.206     1.761    0.085    -0.033     0.491 
         X3     0.014         0.008        0.212     1.645    0.107    -0.003     0.031 
----------------------------------------------------------------------------------------



Forward Selection: Step 6 

+ X1 

                         Model Summary                          
---------------------------------------------------------------
R                       0.749       RMSE                10.961 
R-Squared               0.561       Coef. Var            9.339 
Adj. R-Squared          0.502       MSE                120.153 
Pred R-Squared          0.436       MAE                  8.262 
---------------------------------------------------------------
 RMSE: Root Mean Square Error 
 MSE: Mean Square Error 
 MAE: Mean Absolute Error 

                               ANOVA                                 
--------------------------------------------------------------------
                 Sum of                                             
                Squares        DF    Mean Square      F        Sig. 
--------------------------------------------------------------------
Regression     6905.629         6       1150.938    9.579    0.0000 
Residual       5406.883        45        120.153                    
Total         12312.512        51                                   
--------------------------------------------------------------------

                                  Parameter Estimates                                    
----------------------------------------------------------------------------------------
      model      Beta    Std. Error    Std. Beta      t        Sig      lower     upper 
----------------------------------------------------------------------------------------
(Intercept)    61.217         9.440                  6.485    0.000    42.204    80.230 
         X5     0.050         0.011        0.597     4.383    0.000     0.027     0.073 
         X2     0.089         0.048        0.203     1.844    0.072    -0.008     0.186 
         X4    -0.044         0.017       -0.297    -2.540    0.015    -0.079    -0.009 
         X6     0.215         0.130        0.193     1.655    0.105    -0.047     0.476 
         X3     0.011         0.009        0.175     1.336    0.188    -0.006     0.029 
         X1     0.001         0.001        0.136     1.276    0.209    -0.001     0.003 
----------------------------------------------------------------------------------------



No more variables to be added.

Variables Entered: 

+ X5 
+ X2 
+ X4 
+ X6 
+ X3 
+ X1 


Final Model Output 
------------------

                         Model Summary                          
---------------------------------------------------------------
R                       0.749       RMSE                10.961 
R-Squared               0.561       Coef. Var            9.339 
Adj. R-Squared          0.502       MSE                120.153 
Pred R-Squared          0.436       MAE                  8.262 
---------------------------------------------------------------
 RMSE: Root Mean Square Error 
 MSE: Mean Square Error 
 MAE: Mean Absolute Error 

                               ANOVA                                 
--------------------------------------------------------------------
                 Sum of                                             
                Squares        DF    Mean Square      F        Sig. 
--------------------------------------------------------------------
Regression     6905.629         6       1150.938    9.579    0.0000 
Residual       5406.883        45        120.153                    
Total         12312.512        51                                   
--------------------------------------------------------------------

                                  Parameter Estimates                                    
----------------------------------------------------------------------------------------
      model      Beta    Std. Error    Std. Beta      t        Sig      lower     upper 
----------------------------------------------------------------------------------------
(Intercept)    61.217         9.440                  6.485    0.000    42.204    80.230 
         X5     0.050         0.011        0.597     4.383    0.000     0.027     0.073 
         X2     0.089         0.048        0.203     1.844    0.072    -0.008     0.186 
         X4    -0.044         0.017       -0.297    -2.540    0.015    -0.079    -0.009 
         X6     0.215         0.130        0.193     1.655    0.105    -0.047     0.476 
         X3     0.011         0.009        0.175     1.336    0.188    -0.006     0.029 
         X1     0.001         0.001        0.136     1.276    0.209    -0.001     0.003 
----------------------------------------------------------------------------------------
> k

                            Selection Summary                              
--------------------------------------------------------------------------
        Variable                  Adj.                                        
Step    Entered     R-Square    R-Square     C(p)        AIC        RMSE      
--------------------------------------------------------------------------
   1    X5            0.3449      0.3318    18.7752    415.8625    12.7007    
   2    X2            0.4363      0.4133    11.4664    410.0556    11.9018    
   3    X4            0.4806      0.4481     8.9483    407.7976    11.5428    
   4    X6            0.5182      0.4772     7.1137    405.8883    11.2346    
   5    X3            0.5450      0.4955     6.3843    404.9152    11.0360    
   6    X1            0.5609      0.5023     6.7648    405.0672    10.9614    
--------------------------------------------------------------------------
> plot(k)
> 
> #Stepwise Backward Regression
> #Build regression model from a set of candidate predictor variables by removing predictors
> # based on p values, in a stepwise manner until there is no variable left to remove any more.
> # The model should include all the candidate predictor variables.
> #If details is set to TRUE, each step is displayed.
> 
> k <- ols_step_backward_p(lmod,details=TRUE)
Backward Elimination Method 
---------------------------

Candidate Terms: 

1 . X1 
2 . X2 
3 . X3 
4 . X4 
5 . X5 
6 . X6 
7 . X7 

We are eliminating variables based on p value...

x X7 

Backward Elimination: Step 1 

 Variable X7 Removed 

                         Model Summary                          
---------------------------------------------------------------
R                       0.749       RMSE                10.961 
R-Squared               0.561       Coef. Var            9.339 
Adj. R-Squared          0.502       MSE                120.153 
Pred R-Squared          0.436       MAE                  8.262 
---------------------------------------------------------------
 RMSE: Root Mean Square Error 
 MSE: Mean Square Error 
 MAE: Mean Absolute Error 

                               ANOVA                                 
--------------------------------------------------------------------
                 Sum of                                             
                Squares        DF    Mean Square      F        Sig. 
--------------------------------------------------------------------
Regression     6905.629         6       1150.938    9.579    0.0000 
Residual       5406.883        45        120.153                    
Total         12312.512        51                                   
--------------------------------------------------------------------

                                  Parameter Estimates                                    
----------------------------------------------------------------------------------------
      model      Beta    Std. Error    Std. Beta      t        Sig      lower     upper 
----------------------------------------------------------------------------------------
(Intercept)    61.217         9.440                  6.485    0.000    42.204    80.230 
         X1     0.001         0.001        0.136     1.276    0.209    -0.001     0.003 
         X2     0.089         0.048        0.203     1.844    0.072    -0.008     0.186 
         X3     0.011         0.009        0.175     1.336    0.188    -0.006     0.029 
         X4    -0.044         0.017       -0.297    -2.540    0.015    -0.079    -0.009 
         X5     0.050         0.011        0.597     4.383    0.000     0.027     0.073 
         X6     0.215         0.130        0.193     1.655    0.105    -0.047     0.476 
----------------------------------------------------------------------------------------



No more variables satisfy the condition of p value = 0.3


Variables Removed: 

x X7 


Final Model Output 
------------------

                         Model Summary                          
---------------------------------------------------------------
R                       0.749       RMSE                10.961 
R-Squared               0.561       Coef. Var            9.339 
Adj. R-Squared          0.502       MSE                120.153 
Pred R-Squared          0.436       MAE                  8.262 
---------------------------------------------------------------
 RMSE: Root Mean Square Error 
 MSE: Mean Square Error 
 MAE: Mean Absolute Error 

                               ANOVA                                 
--------------------------------------------------------------------
                 Sum of                                             
                Squares        DF    Mean Square      F        Sig. 
--------------------------------------------------------------------
Regression     6905.629         6       1150.938    9.579    0.0000 
Residual       5406.883        45        120.153                    
Total         12312.512        51                                   
--------------------------------------------------------------------

                                  Parameter Estimates                                    
----------------------------------------------------------------------------------------
      model      Beta    Std. Error    Std. Beta      t        Sig      lower     upper 
----------------------------------------------------------------------------------------
(Intercept)    61.217         9.440                  6.485    0.000    42.204    80.230 
         X1     0.001         0.001        0.136     1.276    0.209    -0.001     0.003 
         X2     0.089         0.048        0.203     1.844    0.072    -0.008     0.186 
         X3     0.011         0.009        0.175     1.336    0.188    -0.006     0.029 
         X4    -0.044         0.017       -0.297    -2.540    0.015    -0.079    -0.009 
         X5     0.050         0.011        0.597     4.383    0.000     0.027     0.073 
         X6     0.215         0.130        0.193     1.655    0.105    -0.047     0.476 
----------------------------------------------------------------------------------------
> k


                           Elimination Summary                            
-------------------------------------------------------------------------
        Variable                  Adj.                                       
Step    Removed     R-Square    R-Square     C(p)       AIC        RMSE      
-------------------------------------------------------------------------
   1    X7            0.5609      0.5023    6.7648    405.0672    10.9614    
-------------------------------------------------------------------------
> plot(k)
geom_path: Each group consists of only one observation. Do you need to adjust the group aesthetic?
geom_path: Each group consists of only one observation. Do you need to adjust the group aesthetic?
geom_path: Each group consists of only one observation. Do you need to adjust the group aesthetic?
geom_path: Each group consists of only one observation. Do you need to adjust the group aesthetic?
geom_path: Each group consists of only one observation. Do you need to adjust the group aesthetic?
geom_path: Each group consists of only one observation. Do you need to adjust the group aesthetic?
> 
> #Stepwise Regression
> #Build regression model from a set of candidate predictor variables by entering and removing predictors
> # based on p values, in a stepwise manner until there is no variable left to enter or remove any more.
> # The model should include all the candidate predictor variables.
> #If details is set to TRUE, each step is displayed.
> 
> k <- ols_step_both_p(lmod,details=TRUE)
Stepwise Selection Method   
---------------------------

Candidate Terms: 

1. X1 
2. X2 
3. X3 
4. X4 
5. X5 
6. X6 
7. X7 

We are selecting variables based on p value...


Stepwise Selection: Step 1 

+ X5 

                         Model Summary                          
---------------------------------------------------------------
R                       0.587       RMSE                12.701 
R-Squared               0.345       Coef. Var           10.820 
Adj. R-Squared          0.332       MSE                161.308 
Pred R-Squared          0.300       MAE                 10.059 
---------------------------------------------------------------
 RMSE: Root Mean Square Error 
 MSE: Mean Square Error 
 MAE: Mean Absolute Error 

                                ANOVA                                 
---------------------------------------------------------------------
                 Sum of                                              
                Squares        DF    Mean Square      F         Sig. 
---------------------------------------------------------------------
Regression     4247.123         1       4247.123    26.329    0.0000 
Residual       8065.390        50        161.308                     
Total         12312.512        51                                    
---------------------------------------------------------------------

                                   Parameter Estimates                                    
-----------------------------------------------------------------------------------------
      model      Beta    Std. Error    Std. Beta      t        Sig      lower      upper 
-----------------------------------------------------------------------------------------
(Intercept)    88.193         5.954                 14.812    0.000    76.234    100.152 
         X5     0.049         0.010        0.587     5.131    0.000     0.030      0.068 
-----------------------------------------------------------------------------------------



Stepwise Selection: Step 2 

+ X2 

                         Model Summary                          
---------------------------------------------------------------
R                       0.661       RMSE                11.902 
R-Squared               0.436       Coef. Var           10.140 
Adj. R-Squared          0.413       MSE                141.654 
Pred R-Squared          0.377       MAE                  9.727 
---------------------------------------------------------------
 RMSE: Root Mean Square Error 
 MSE: Mean Square Error 
 MAE: Mean Absolute Error 

                                ANOVA                                 
---------------------------------------------------------------------
                 Sum of                                              
                Squares        DF    Mean Square      F         Sig. 
---------------------------------------------------------------------
Regression     5371.484         2       2685.742     18.96    0.0000 
Residual       6941.028        49        141.654                     
Total         12312.512        51                                    
---------------------------------------------------------------------

                                  Parameter Estimates                                    
----------------------------------------------------------------------------------------
      model      Beta    Std. Error    Std. Beta      t        Sig      lower     upper 
----------------------------------------------------------------------------------------
(Intercept)    75.966         7.069                 10.747    0.000    61.762    90.171 
         X5     0.050         0.009        0.592     5.520    0.000     0.032     0.068 
         X2     0.132         0.047        0.302     2.817    0.007     0.038     0.226 
----------------------------------------------------------------------------------------



                         Model Summary                          
---------------------------------------------------------------
R                       0.661       RMSE                11.902 
R-Squared               0.436       Coef. Var           10.140 
Adj. R-Squared          0.413       MSE                141.654 
Pred R-Squared          0.377       MAE                  9.727 
---------------------------------------------------------------
 RMSE: Root Mean Square Error 
 MSE: Mean Square Error 
 MAE: Mean Absolute Error 

                                ANOVA                                 
---------------------------------------------------------------------
                 Sum of                                              
                Squares        DF    Mean Square      F         Sig. 
---------------------------------------------------------------------
Regression     5371.484         2       2685.742     18.96    0.0000 
Residual       6941.028        49        141.654                     
Total         12312.512        51                                    
---------------------------------------------------------------------

                                  Parameter Estimates                                    
----------------------------------------------------------------------------------------
      model      Beta    Std. Error    Std. Beta      t        Sig      lower     upper 
----------------------------------------------------------------------------------------
(Intercept)    75.966         7.069                 10.747    0.000    61.762    90.171 
         X5     0.050         0.009        0.592     5.520    0.000     0.032     0.068 
         X2     0.132         0.047        0.302     2.817    0.007     0.038     0.226 
----------------------------------------------------------------------------------------



Stepwise Selection: Step 3 

+ X4 

                         Model Summary                          
---------------------------------------------------------------
R                       0.693       RMSE                11.543 
R-Squared               0.481       Coef. Var            9.834 
Adj. R-Squared          0.448       MSE                133.236 
Pred R-Squared          0.414       MAE                  9.105 
---------------------------------------------------------------
 RMSE: Root Mean Square Error 
 MSE: Mean Square Error 
 MAE: Mean Absolute Error 

                                ANOVA                                 
---------------------------------------------------------------------
                 Sum of                                              
                Squares        DF    Mean Square      F         Sig. 
---------------------------------------------------------------------
Regression     5917.200         3       1972.400    14.804    0.0000 
Residual       6395.312        48        133.236                     
Total         12312.512        51                                    
---------------------------------------------------------------------

                                  Parameter Estimates                                    
----------------------------------------------------------------------------------------
      model      Beta    Std. Error    Std. Beta      t        Sig      lower     upper 
----------------------------------------------------------------------------------------
(Intercept)    77.726         6.910                 11.248    0.000    63.832    91.620 
         X5     0.058         0.010        0.696     5.998    0.000     0.039     0.078 
         X2     0.136         0.045        0.313     3.001    0.004     0.045     0.228 
         X4    -0.035         0.017       -0.235    -2.024    0.049    -0.069     0.000 
----------------------------------------------------------------------------------------



                         Model Summary                          
---------------------------------------------------------------
R                       0.693       RMSE                11.543 
R-Squared               0.481       Coef. Var            9.834 
Adj. R-Squared          0.448       MSE                133.236 
Pred R-Squared          0.414       MAE                  9.105 
---------------------------------------------------------------
 RMSE: Root Mean Square Error 
 MSE: Mean Square Error 
 MAE: Mean Absolute Error 

                                ANOVA                                 
---------------------------------------------------------------------
                 Sum of                                              
                Squares        DF    Mean Square      F         Sig. 
---------------------------------------------------------------------
Regression     5917.200         3       1972.400    14.804    0.0000 
Residual       6395.312        48        133.236                     
Total         12312.512        51                                    
---------------------------------------------------------------------

                                  Parameter Estimates                                    
----------------------------------------------------------------------------------------
      model      Beta    Std. Error    Std. Beta      t        Sig      lower     upper 
----------------------------------------------------------------------------------------
(Intercept)    77.726         6.910                 11.248    0.000    63.832    91.620 
         X5     0.058         0.010        0.696     5.998    0.000     0.039     0.078 
         X2     0.136         0.045        0.313     3.001    0.004     0.045     0.228 
         X4    -0.035         0.017       -0.235    -2.024    0.049    -0.069     0.000 
----------------------------------------------------------------------------------------



Stepwise Selection: Step 4 

+ X6 

                         Model Summary                          
---------------------------------------------------------------
R                       0.720       RMSE                11.235 
R-Squared               0.518       Coef. Var            9.571 
Adj. R-Squared          0.477       MSE                126.216 
Pred R-Squared          0.431       MAE                  8.992 
---------------------------------------------------------------
 RMSE: Root Mean Square Error 
 MSE: Mean Square Error 
 MAE: Mean Absolute Error 

                                ANOVA                                 
---------------------------------------------------------------------
                 Sum of                                              
                Squares        DF    Mean Square      F         Sig. 
---------------------------------------------------------------------
Regression     6380.360         4       1595.090    12.638    0.0000 
Residual       5932.152        47        126.216                     
Total         12312.512        51                                    
---------------------------------------------------------------------

                                  Parameter Estimates                                    
----------------------------------------------------------------------------------------
      model      Beta    Std. Error    Std. Beta      t        Sig      lower     upper 
----------------------------------------------------------------------------------------
(Intercept)    70.449         7.724                  9.121    0.000    54.910    85.988 
         X5     0.051         0.010        0.606     4.957    0.000     0.030     0.071 
         X2     0.102         0.048        0.234     2.143    0.037     0.006     0.198 
         X4    -0.034         0.017       -0.230    -2.036    0.047    -0.068     0.000 
         X6     0.252         0.132        0.226     1.916    0.062    -0.013     0.517 
----------------------------------------------------------------------------------------



                         Model Summary                          
---------------------------------------------------------------
R                       0.720       RMSE                11.235 
R-Squared               0.518       Coef. Var            9.571 
Adj. R-Squared          0.477       MSE                126.216 
Pred R-Squared          0.431       MAE                  8.992 
---------------------------------------------------------------
 RMSE: Root Mean Square Error 
 MSE: Mean Square Error 
 MAE: Mean Absolute Error 

                                ANOVA                                 
---------------------------------------------------------------------
                 Sum of                                              
                Squares        DF    Mean Square      F         Sig. 
---------------------------------------------------------------------
Regression     6380.360         4       1595.090    12.638    0.0000 
Residual       5932.152        47        126.216                     
Total         12312.512        51                                    
---------------------------------------------------------------------

                                  Parameter Estimates                                    
----------------------------------------------------------------------------------------
      model      Beta    Std. Error    Std. Beta      t        Sig      lower     upper 
----------------------------------------------------------------------------------------
(Intercept)    70.449         7.724                  9.121    0.000    54.910    85.988 
         X5     0.051         0.010        0.606     4.957    0.000     0.030     0.071 
         X2     0.102         0.048        0.234     2.143    0.037     0.006     0.198 
         X4    -0.034         0.017       -0.230    -2.036    0.047    -0.068     0.000 
         X6     0.252         0.132        0.226     1.916    0.062    -0.013     0.517 
----------------------------------------------------------------------------------------



No more variables to be added/removed.


Final Model Output 
------------------

                         Model Summary                          
---------------------------------------------------------------
R                       0.720       RMSE                11.235 
R-Squared               0.518       Coef. Var            9.571 
Adj. R-Squared          0.477       MSE                126.216 
Pred R-Squared          0.431       MAE                  8.992 
---------------------------------------------------------------
 RMSE: Root Mean Square Error 
 MSE: Mean Square Error 
 MAE: Mean Absolute Error 

                                ANOVA                                 
---------------------------------------------------------------------
                 Sum of                                              
                Squares        DF    Mean Square      F         Sig. 
---------------------------------------------------------------------
Regression     6380.360         4       1595.090    12.638    0.0000 
Residual       5932.152        47        126.216                     
Total         12312.512        51                                    
---------------------------------------------------------------------

                                  Parameter Estimates                                    
----------------------------------------------------------------------------------------
      model      Beta    Std. Error    Std. Beta      t        Sig      lower     upper 
----------------------------------------------------------------------------------------
(Intercept)    70.449         7.724                  9.121    0.000    54.910    85.988 
         X5     0.051         0.010        0.606     4.957    0.000     0.030     0.071 
         X2     0.102         0.048        0.234     2.143    0.037     0.006     0.198 
         X4    -0.034         0.017       -0.230    -2.036    0.047    -0.068     0.000 
         X6     0.252         0.132        0.226     1.916    0.062    -0.013     0.517 
----------------------------------------------------------------------------------------
> k

                              Stepwise Selection Summary                               
--------------------------------------------------------------------------------------
                     Added/                   Adj.                                        
Step    Variable    Removed     R-Square    R-Square     C(p)        AIC        RMSE      
--------------------------------------------------------------------------------------
   1       X5       addition       0.345       0.332    18.7750    415.8625    12.7007    
   2       X2       addition       0.436       0.413    11.4660    410.0556    11.9018    
   3       X4       addition       0.481       0.448     8.9480    407.7976    11.5428    
   4       X6       addition       0.518       0.477     7.1140    405.8883    11.2346    
--------------------------------------------------------------------------------------
> plot(k)
> 
> #Stepwise models based on Akaike Information Criteria criterion
> k <- ols_step_forward_aic(lmod) #forward selection
> k

                         Selection Summary                           
--------------------------------------------------------------------
Variable       AIC       Sum Sq       RSS        R-Sq      Adj. R-Sq 
--------------------------------------------------------------------
X5           415.862    4247.123    8065.390    0.34494      0.33184 
X2           410.056    5371.484    6941.028    0.43626      0.41325 
X4           407.798    5917.200    6395.312    0.48058      0.44812 
X6           405.888    6380.360    5932.152    0.51820      0.47720 
X3           404.915    6710.023    5602.489    0.54498      0.49552 
--------------------------------------------------------------------
> plot(k)
> 
> k <- ols_step_backward_aic(lmod)
> k


                     Backward Elimination Summary                      
---------------------------------------------------------------------
Variable        AIC        RSS        Sum Sq      R-Sq      Adj. R-Sq 
---------------------------------------------------------------------
Full Model    406.171    5314.503    6998.009    0.56837      0.49970 
X7            405.067    5406.883    6905.629    0.56086      0.50231 
X1            404.915    5602.489    6710.023    0.54498      0.49552 
---------------------------------------------------------------------

> plot(k)
> 
> k <- ols_step_both_aic(lmod)
> k


                                Stepwise Summary                                 
-------------------------------------------------------------------------------
Variable     Method       AIC        RSS        Sum Sq      R-Sq      Adj. R-Sq 
-------------------------------------------------------------------------------
X5          addition    415.862    8065.390    4247.123    0.34494      0.33184 
X2          addition    410.056    6941.028    5371.484    0.43626      0.41325 
X4          addition    407.798    6395.312    5917.200    0.48058      0.44812 
X6          addition    405.888    5932.152    6380.360    0.51820      0.47720 
X3          addition    404.915    5602.489    6710.023    0.54498      0.49552 
-------------------------------------------------------------------------------

> plot(k)
> 
> ##----------------------------------------##
> 
> dev.off()
null device 
          1 
> 
